"use strict";var calendarHeatmap={settings:{gutter:5,item_gutter:1,width:1e3,height:550,item_size:30,label_padding:40,max_block_height:20,transition_duration:500,tooltip_width:250,tooltip_padding:15},init:function(e,t,a,n,r,l){moment.updateLocale("en",{week:{dow:1}}),calendarHeatmap.data=calendarHeatmap.parseServerData(e),calendarHeatmap.container=t,calendarHeatmap.objColorConfig=a||"#ff4500",calendarHeatmap.overview=n||"global",calendarHeatmap.customType=l||"month",calendarHeatmap.history=["global"],calendarHeatmap.selected={},calendarHeatmap.currDate=moment(),calendarHeatmap.handler=r,calendarHeatmap.in_transition=!1,calendarHeatmap.createElements(),calendarHeatmap.parseData(),calendarHeatmap.drawChart()},createElements:function(){if(null!=calendarHeatmap.container){if(!(e=document.getElementById(calendarHeatmap.container))||"DIV"!=e.tagName)throw"Element not found or not of type div";e.classList.contains("calendar-heatmap")||e.classList.add("calendar-heatmap")}else{var e;(e=document.createElement("div")).className="calendar-heatmap",document.body.appendChild(e)}var t=d3.select(e).append("svg").attr("class","svg");calendarHeatmap.items=t.append("g"),calendarHeatmap.labels=t.append("g"),calendarHeatmap.buttons=t.append("g"),calendarHeatmap.tooltip=d3.select(e).append("div").attr("class","heatmap-tooltip").style("opacity",0);var a=function(){var a=Math.round((moment()-moment().subtract(1,"year").startOf("week"))/864e5),n=Math.trunc(a/7)+1;calendarHeatmap.settings.width=e.offsetWidth<1200?1200:e.offsetWidth,calendarHeatmap.settings.item_size=(calendarHeatmap.settings.width-calendarHeatmap.settings.label_padding)/n-calendarHeatmap.settings.gutter<20?25:(calendarHeatmap.settings.width-calendarHeatmap.settings.label_padding)/n-calendarHeatmap.settings.gutter,t.attr("width",calendarHeatmap.settings.width).attr("height",calendarHeatmap.settings.height),calendarHeatmap.data&&calendarHeatmap.data[0].summary&&calendarHeatmap.drawChart()};a(),window.onresize=function(e){a()}},parseData:function(){calendarHeatmap.data&&(calendarHeatmap.data[0].summary||calendarHeatmap.data.map((function(e){var t=e.details.reduce((function(e,t){return e[t.name]?(e[t.name].value+=t.value,e[t.name].type=t.type):e[t.name]={value:t.value,type:t.type},e}),{}),a=Object.keys(t).map((function(e){return{name:e,value:t[e].value,type:t[e].type}}));return e.summary=a.sort((function(e,t){return e.type-t.type||e.value-t.value})),e})))},parseServerData:function(e){var t={};for(var a of e){var n=a[1].match(/T/)?a[1].replaceAll(/T(\d+:)*\d+\+/gi,"T00:00:00+"):a[1].replaceAll(/\s(\d+:)*\d+/gi,"T00:00:00");t[n]||(t[n]=[]),t[n].push(a)}var r=[];for(var l in t){var i,o=[],d=0,s=null;t[l].forEach((function(e,t){o.push({date:e[1],name:e[2],value:e[4],strProjects:e[0],type:e[6]}),s=e[0].match(/Public/)||e[0].match(/Sick/)||e[0].match(/Annual/)?e[0]:s,d+=e[4]})),i=o[0].strProjects.substring(o[0].strProjects.indexOf("|")+1,o[0].strProjects.indexOf(":")),o.sort((function(e,t){return e.type>t.type})),r.push({date:l,details:o,total:d,strProjects:1==o.length?o[0].strProjects:calendarHeatmap.getProjectFormattedString(o,"strProjects"),strWeekSummary:calendarHeatmap.getProjectFormattedString(o,"name"),strToolTip:1==o.length?i:null,type:o[0].type})}return console.log(r),r.sort((function(e,t){return moment(e.date)-moment(t.date)})),r},getProjectFormattedString:function(e,t){var a=[];return e.forEach((function(e,n){a.push(e[t])})),a.reduce((function(e,t){return e.indexOf(t)<0&&e.push(t),e}),[]).toString()},drawChart:function(){"global"===calendarHeatmap.overview?calendarHeatmap.drawGlobalOverview():"year"===calendarHeatmap.overview?calendarHeatmap.drawYearOverview():"month"===calendarHeatmap.overview?calendarHeatmap.drawMonthOverview2():"week"===calendarHeatmap.overview?calendarHeatmap.drawWeekOverview():"day"===calendarHeatmap.overview&&("dayCompact"===calendarHeatmap.customType?calendarHeatmap.drawCompactDayOverview():calendarHeatmap.drawDayOverview())},drawGlobalOverview:function(){calendarHeatmap.history[calendarHeatmap.history.length-1]!==calendarHeatmap.overview&&calendarHeatmap.history.push(calendarHeatmap.overview);var e=moment(calendarHeatmap.data[0].date).startOf("year"),t=moment(calendarHeatmap.data[calendarHeatmap.data.length-1].date).endOf("year"),a=d3.timeYears(e,t).map((function(e){var t,a=moment(e);return{date:a,total:calendarHeatmap.data.reduce((function(e,t){return moment(t.date).year()===a.year()&&3!=t.type&&(e+=t.total),e}),0),summary:(t=calendarHeatmap.data.reduce((function(e,t){if(moment(t.date).year()===a.year())for(var n=0;n<t.summary.length;n++)e[t.summary[n].name]?e[t.summary[n].name].value+=t.summary[n].value:e[t.summary[n].name]={value:t.summary[n].value};return e}),{}),Object.keys(t).map((function(e){return{name:e,value:t[e].value}})).sort((function(e,t){return t.value-e.value})))}}));a=a.filter((function(e){return!(moment(e.date).year()<calendarHeatmap.currDate.year()&&0==e.total)}));var n=d3.max(a,(function(e){return e.total}));d3.min(a,(function(e){return e.total}));calendarHeatmap.items.selectAll(".item-block-month").remove(),calendarHeatmap.items.selectAll(".text").remove(),calendarHeatmap.items.selectAll(".item-rect").remove(),calendarHeatmap.items.selectAll(".item-rect").remove(),calendarHeatmap.labels.selectAll(".label-monthDate").remove();var r=d3.timeYears(moment(a[0].date).startOf("year"),1==a.length?moment(a[0].date).endOf("year"):moment(a[a.length-1].date).endOf("year")).map((function(e){return moment(e)})),l=d3.scaleBand().rangeRound([0,calendarHeatmap.settings.width]).padding([.05]).domain(r.map((function(e){return e.year()})));calendarHeatmap.items.selectAll(".item-block-year").remove();calendarHeatmap.items.selectAll(".item-block-year").data(a).enter().append("rect").attr("class","item item-block-year").attr("width",(function(){return(calendarHeatmap.settings.width-calendarHeatmap.settings.label_padding)/r.length-5*calendarHeatmap.settings.gutter})).attr("height",(function(){return calendarHeatmap.settings.height-calendarHeatmap.settings.label_padding})).attr("transform",(function(e){return"translate("+l(e.date.year())+","+2*calendarHeatmap.settings.tooltip_padding+")"})).attr("stroke","#292929").attr("fill",(function(e){return d3.scaleLinear().range(["#fff6ed",calendarHeatmap.color||"#fff6ed"]).domain([-.15*n,n])(e.total)||"#fff6ed"})).on("click",(function(e){calendarHeatmap.in_transition||(calendarHeatmap.in_transition=!0,calendarHeatmap.selected=e,calendarHeatmap.hideTooltip(),calendarHeatmap.removeGlobalOverview(),calendarHeatmap.overview="year",calendarHeatmap.drawChart())})).style("opacity",0).on("mouseover",(function(e){if(!calendarHeatmap.in_transition){var t="";t+="<div><span><strong>Total time booked:</strong></span>";var a=parseInt(e.total,10),n=Math.floor(a/28800);n>0&&(t+="<span>"+(1===n?"1 day":n+" days")+"</span></div>");var r=Math.floor((a-28800*n)/3600);r>0&&(t+=n>0?"<div><span></span><span>"+(1===r?"1 hour":r+" hours")+"</span></div>":"<span>"+(1===r?"1 hour":r+" hours")+"</span></div>");var i=Math.floor((a-28800*n-3600*r)/60);if(i>0&&(t+=n>0||r>0?"<div><span></span><span>"+(1===i?"1 minute":i+" minutes")+"</span></div>":"<span>"+(1===i?"1 minute":i+" minutes")+"</span></div>"),0==a&&(t+="<span>--</span>"),t+="<br />",0==e.total&&(e.summary=[]),e.summary.length<=5)for(var o=0;o<e.summary.length;o++)t+="<div><span><strong>"+e.summary[o].name+"</strong></span>",t+="<span>"+calendarHeatmap.formatTime(e.summary[o].value)+"</span></div>";else{for(o=0;o<5;o++)t+="<div><span><strong>"+e.summary[o].name+"</strong></span>",t+="<span>"+calendarHeatmap.formatTime(e.summary[o].value)+"</span></div>";t+="<br />";var d=0;for(o=5;o<e.summary.length;o++)d=+e.summary[o].value;t+="<div><span><strong>Other:</strong></span>",t+="<span>"+calendarHeatmap.formatTime(d)+"</span></div>"}for(var s=l(e.date.year())+2*calendarHeatmap.settings.tooltip_padding;calendarHeatmap.settings.width-s<calendarHeatmap.settings.tooltip_width+5*calendarHeatmap.settings.tooltip_padding;)s-=10;var m=document.getElementById(calendarHeatmap.container).getBoundingClientRect().top>500?400:document.getElementById(calendarHeatmap.container).getBoundingClientRect().top,c=Math.abs(m-document.getElementById(calendarHeatmap.container).getBoundingClientRect().height)+calendarHeatmap.settings.tooltip_padding;calendarHeatmap.tooltip.html(t).style("left",s+"px").style("top",c+"px").transition().duration(calendarHeatmap.settings.transition_duration/2).ease(d3.easeLinear).style("opacity",1)}})).on("mouseout",(function(){calendarHeatmap.in_transition||calendarHeatmap.hideTooltip()})).transition().delay((function(e,t){return calendarHeatmap.settings.transition_duration*(t+1)/10})).duration((function(){return calendarHeatmap.settings.transition_duration})).ease(d3.easeLinear).style("opacity",1).call((function(e,t){e.empty()&&t();var a=0;e.each((function(){++a})).on("end",(function(){--a||t.apply(this,arguments)}))}),(function(){calendarHeatmap.in_transition=!1}));calendarHeatmap.labels.selectAll(".label-year").remove(),calendarHeatmap.labels.selectAll(".label-year").data(r).enter().append("text").attr("class","label label-year").attr("font-size",(function(){return Math.floor(calendarHeatmap.settings.label_padding/3)+"px"})).text((function(e){return e.year()})).attr("x",(function(e){return l(e.year())})).attr("y",calendarHeatmap.settings.label_padding/2).on("mouseenter",(function(e){calendarHeatmap.in_transition||calendarHeatmap.items.selectAll(".item-block-year").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",(function(t){return moment(t.date).year()===e.year()?1:.1}))})).on("mouseout",(function(){calendarHeatmap.in_transition||calendarHeatmap.items.selectAll(".item-block-year").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",1)})).on("click",(function(e){calendarHeatmap.in_transition||(calendarHeatmap.in_transition=!0,calendarHeatmap.selected={date:e},calendarHeatmap.hideTooltip(),calendarHeatmap.removeGlobalOverview(),calendarHeatmap.overview="year",calendarHeatmap.drawChart())}))},drawYearOverview:function(){calendarHeatmap.history[calendarHeatmap.history.length-1]!==calendarHeatmap.overview&&calendarHeatmap.history.push(calendarHeatmap.overview);var e=moment(calendarHeatmap.selected.date).startOf("year"),t=moment(calendarHeatmap.selected.date).endOf("year"),a=calendarHeatmap.data.filter((function(a){return e<=moment(a.date)&&moment(a.date)<t})),n=calendarHeatmap.mergeMissingDates(e,t,a),r=d3.max(n,(function(e){return e.total})),l=d3.timeDays(moment().startOf("week"),moment().endOf("week")),i=d3.scaleBand().rangeRound([calendarHeatmap.settings.label_padding,calendarHeatmap.settings.height-200]).domain(l.map((function(e){return moment(e).weekday()}))),o=(d3.scaleLinear().range(["#ffffff",calendarHeatmap.color||"#ff4500"]).domain([-.15*r,r]),function(t,a){var n=moment(t.date),r=Math.round((n-moment(e).startOf("week"))/864e5);return Math.trunc(r/7)*(calendarHeatmap.settings.item_size+calendarHeatmap.settings.gutter)+calendarHeatmap.settings.label_padding}),d=function(e,t){return calendarHeatmap.settings.label_padding+moment(e.date).weekday()*(calendarHeatmap.settings.item_size+10+calendarHeatmap.settings.gutter)+10},s=function(e){return calendarHeatmap.settings.item_size};calendarHeatmap.items.selectAll(".item-block-month").remove(),calendarHeatmap.items.selectAll(".text").remove(),calendarHeatmap.items.selectAll(".item-rect").remove(),calendarHeatmap.items.selectAll(".item-rect").data(n).enter().append("rect").attr("class","item item-rect").style("opacity",0).attr("x",(function(e,t){return o(e)+(calendarHeatmap.settings.item_size-s())/2})).attr("y",(function(e,t){return d(e)+(calendarHeatmap.settings.item_size-s())/2})).attr("width",(function(e){return s()})).attr("height",(function(e){return s()})).attr("stroke",(function(e){return e.total>0?"#292929":"#ccc"})).attr("fill",(function(e){return e.total>0?calendarHeatmap.getColor(e.total,e):"#fff"})).on("click",(function(e){calendarHeatmap.in_transition||0!==e.total&&(calendarHeatmap.in_transition=!0,calendarHeatmap.selected=e,calendarHeatmap.hideTooltip(),calendarHeatmap.removeYearOverview(),calendarHeatmap.overview="day",calendarHeatmap.drawChart())})).on("mouseover",(function(e){if(!(calendarHeatmap.in_transition||e.total<=0)){var t=d3.select(this);!function e(){t=t.transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).attr("x",(function(e){return o(e)-(1.1*calendarHeatmap.settings.item_size-calendarHeatmap.settings.item_size)/2})).attr("y",(function(e,t){return d(e)-(1.1*calendarHeatmap.settings.item_size-calendarHeatmap.settings.item_size)/2})).attr("width",1.1*calendarHeatmap.settings.item_size).attr("height",1.1*calendarHeatmap.settings.item_size).transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).attr("x",(function(e){return o(e)+(calendarHeatmap.settings.item_size-s())/2})).attr("y",(function(e,t){return d(e)+(calendarHeatmap.settings.item_size-s())/2})).attr("width",(function(e){return s()})).attr("height",(function(e){return s()})).on("end",e)}();var a="";if(3==e.type)a+='<div class="header"><strong>'+e.strProjects+"</strong><div><br>",a+="<div>on "+moment(e.date).format("dddd, MMM Do YYYY")+"</div>";else{a+='<div class="header"><strong>'+(e.total?calendarHeatmap.formatTime(e.total):"No time")+" booked</strong></div>",a+="<div>on "+moment(e.date).format("dddd, MMM Do YYYY")+"</div><br>";for(var n=0;n<e.summary.length;n++)e&&e.strToolTip&&(a+="<div><span><strong>"+(e.strToolTip.match(/Sick/)||e.strToolTip.match(/Annual/)||e.strToolTip.match(/Public/)?e.strToolTip:"")+"</strong></span>"),a+="<div><span><strong>"+e.summary[n].name+"</strong></span>",a+="<span>"+calendarHeatmap.formatTime(e.summary[n].value)+"</span></div>"}var r=o(e)+calendarHeatmap.settings.item_size;calendarHeatmap.settings.width-r<calendarHeatmap.settings.tooltip_width+3*calendarHeatmap.settings.tooltip_padding&&(r-=calendarHeatmap.settings.tooltip_width+2*calendarHeatmap.settings.tooltip_padding);var l=document.getElementById(calendarHeatmap.container).getBoundingClientRect().top>500?400:document.getElementById(calendarHeatmap.container).getBoundingClientRect().top,i=Math.abs(l-document.getElementById(calendarHeatmap.container).getBoundingClientRect().height)+calendarHeatmap.settings.tooltip_padding;calendarHeatmap.tooltip.html(a).style("left",r+"px").style("top",i+"px").transition().duration(calendarHeatmap.settings.transition_duration/2).ease(d3.easeLinear).style("opacity",1)}})).on("mouseout",(function(){calendarHeatmap.in_transition||(d3.select(this).transition().duration(calendarHeatmap.settings.transition_duration/2).ease(d3.easeLinear).attr("x",(function(e){return o(e)+(calendarHeatmap.settings.item_size-s())/2})).attr("y",(function(e,t){return d(e)+(calendarHeatmap.settings.item_size-s())/2})).attr("width",(function(e){return s()})).attr("height",(function(e){return s()})),calendarHeatmap.hideTooltip())})).transition().delay((function(){return(Math.cos(Math.PI*Math.random())+1)*calendarHeatmap.settings.transition_duration})).duration((function(){return calendarHeatmap.settings.transition_duration})).ease(d3.easeLinear).style("opacity",1).call((function(e,t){e.empty()&&t();var a=0;e.each((function(){++a})).on("end",(function(){--a||t.apply(this,arguments)}))}),(function(){calendarHeatmap.in_transition=!1})),calendarHeatmap.labels.selectAll(".label-monthDate").remove(),calendarHeatmap.labels.selectAll(".label-dayDate").remove();calendarHeatmap.items.selectAll(".text").remove(),calendarHeatmap.items.selectAll(".text").data(n).enter().append("text").attr("class",(function(e){return calendarHeatmap.isCurrentMonth(e)?"text currMoment":"text"})).text((function(e,t){return moment(e.date).format("DD")})).style("opacity",1).style("fill",(function(e,t){return e.total>0?calendarHeatmap.getTextColor(e.total,e,""):"#bfbfbf"})).attr("text-anchor","middle").attr("y",(function(e,t){return 12.5+(d(e)+(calendarHeatmap.settings.item_size-s())/2)})).attr("x",(function(e,t){return 10+(o(e)+(calendarHeatmap.settings.item_size-s())/2)}));var m=d3.timeMonths(e,t),c=d3.scaleLinear().range([0,calendarHeatmap.settings.width-100]).domain([0,m.length]);calendarHeatmap.labels.selectAll(".label-month").remove(),calendarHeatmap.labels.selectAll(".label-month").data(m).enter().append("text").attr("class",(function(e){return calendarHeatmap.isCurrentMonth(e,"month")?"label label-month currMoment":"label label-month"})).attr("font-size",(function(e){return(calendarHeatmap.isCurrentMonth(e)?Math.floor(calendarHeatmap.settings.label_padding/3)+1:Math.floor(calendarHeatmap.settings.label_padding/3))+"px"})).text((function(e){return e.toLocaleDateString("en-us",{month:"short"})+","+moment(calendarHeatmap.selected.date).format("YYYY")})).attr("x",(function(e,t){return c(t)+(c(t)-c(t-1))/2})).attr("y",calendarHeatmap.settings.label_padding/2).on("mouseenter",(function(e){if(!calendarHeatmap.in_transition){var t=moment(e);calendarHeatmap.items.selectAll(".item-rect").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",(function(e){return moment(e.date).isSame(t,"month")?1:.1})),calendarHeatmap.items.selectAll(".text").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",(function(e){return moment(e.date).isSame(t,"month")?1:.1}))}})).on("mouseout",(function(){calendarHeatmap.in_transition||(calendarHeatmap.items.selectAll(".item-rect").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",1),calendarHeatmap.items.selectAll(".text").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",1))})).on("click",(function(e){calendarHeatmap.in_transition||calendarHeatmap.data.filter((function(t){return moment(e).startOf("month")<=moment(t.date)&&moment(t.date)<moment(e).endOf("month")})).length&&(calendarHeatmap.selected={date:e},calendarHeatmap.in_transition=!0,calendarHeatmap.hideTooltip(),calendarHeatmap.removeYearOverview(),calendarHeatmap.overview="month",calendarHeatmap.drawChart())})),calendarHeatmap.labels.selectAll(".label-day").remove(),calendarHeatmap.labels.selectAll(".label-day").data(l).enter().append("text").attr("class",(function(e){return calendarHeatmap.isCurrentMonth(e)?"label label-day currMoment":"label label-day"})).attr("x",calendarHeatmap.settings.label_padding/3).attr("y",(function(e,t){return i(t)+i.bandwidth()/1.75})).style("text-anchor","left").attr("font-size",(function(e){return(calendarHeatmap.isCurrentMonth(e)?Math.floor(calendarHeatmap.settings.label_padding/3)+1:Math.floor(calendarHeatmap.settings.label_padding/3))+"px"})).text((function(e){return moment(e).format("dddd")[0]+moment(e).format("dddd")[1]+moment(e).format("dddd")[2]})).on("mouseenter",(function(e){if(!calendarHeatmap.in_transition){var t=moment(e);calendarHeatmap.items.selectAll(".item-rect").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",(function(e){return moment(e.date).day()===t.day()?1:.1})),calendarHeatmap.items.selectAll(".text").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",(function(e){return moment(e.date).day()===t.day()?1:.1}))}})).on("mouseout",(function(){calendarHeatmap.in_transition||(calendarHeatmap.items.selectAll(".item-rect").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",1),calendarHeatmap.items.selectAll(".text").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",1))})),calendarHeatmap.drawButton()},drawMonthOverview:function(){calendarHeatmap.items.selectAll(".text").remove(),calendarHeatmap.history[calendarHeatmap.history.length-1]!==calendarHeatmap.overview&&calendarHeatmap.history.push(calendarHeatmap.overview);for(var e=moment(calendarHeatmap.selected.date).startOf("month"),t=moment(calendarHeatmap.selected.date).endOf("month"),a=calendarHeatmap.data.filter((function(a){return e<=moment(a.date)&&moment(a.date)<t})),n=calendarHeatmap.mergeMissingDates(e,t,a),r=d3.max(n,(function(e){return d3.max(e.summary,(function(e){return e.value}))})),l=d3.timeDays(moment().startOf("week"),moment().endOf("week")),i=d3.scaleBand().rangeRound([calendarHeatmap.settings.label_padding,calendarHeatmap.settings.height]).domain(l.map((function(e){return moment(e).weekday()}))),o=[e.clone()];e.week()!==t.week();)o.push(e.add(1,"week").clone());var d=d3.scaleBand().rangeRound([calendarHeatmap.settings.label_padding,calendarHeatmap.settings.width]).padding([.05]).domain(o.map((function(e){return e.week()})));calendarHeatmap.labels.selectAll(".label-monthDate").remove(),calendarHeatmap.labels.selectAll(".label-dayDate").remove(),calendarHeatmap.items.selectAll(".item-block-month").remove();var s=calendarHeatmap.items.selectAll(".item-block-month").data(n).enter().append("g").attr("class","item item-block-month").attr("width",(function(){return(calendarHeatmap.settings.width-calendarHeatmap.settings.label_padding)/o.length-5*calendarHeatmap.settings.gutter})).attr("height",(function(){return Math.max(i.bandwidth(),calendarHeatmap.settings.max_block_height)-calendarHeatmap.settings.label_padding})).attr("transform",(function(e){return"translate("+d(moment(e.date).week())+","+(i(moment(e.date).weekday())+i.bandwidth()/1.75-15)+")"})).attr("total",(function(e){return e.total})).attr("date",(function(e){return e.date})).attr("offset",0).attr("lblOffset",0).on("click",(function(e){calendarHeatmap.in_transition||0!==e.total&&(calendarHeatmap.in_transition=!0,calendarHeatmap.selected=e,calendarHeatmap.hideTooltip(),calendarHeatmap.removeMonthOverview(),calendarHeatmap.overview="day",calendarHeatmap.drawChart())})),m=(calendarHeatmap.settings.width-calendarHeatmap.settings.label_padding)/o.length-5*calendarHeatmap.settings.gutter,c=d3.scaleLinear().rangeRound([0,m]);s.selectAll(".item-block-rect").data((function(e){return e.summary})).enter().append("rect").attr("class","item item-block-rect").attr("x",(function(e){var t=parseInt(d3.select(this.parentNode).attr("total")),a=parseInt(d3.select(this.parentNode).attr("offset"));return c.domain([0,t]),d3.select(this.parentNode).attr("offset",a+c(e.value)),a})).attr("stroke",(function(e){return e.value>0?"#292929":"#ccc"})).attr("width",(function(e){var t=parseInt(d3.select(this.parentNode).attr("total"));return c.domain([0,t]),e.value<=0?d3.select(this.parentNode).attr("width"):Math.max(c(e.value)-calendarHeatmap.settings.item_gutter,1)})).attr("height",(function(){return Math.min(i.bandwidth(),calendarHeatmap.settings.max_block_height)+.75*calendarHeatmap.settings.item_gutter})).attr("fill",(function(e){var t=[calendarHeatmap.getColor(e.value,d3.select(this.parentNode).datum()),calendarHeatmap.getColor(e.value,d3.select(this.parentNode).datum())],a=d3.scaleLinear().range(t).domain([-.15*r,r]);return e.value>0?a(e.value)||"#ff4500":"#fff"})).style("opacity",0).on("mouseover",(function(e){if(!(calendarHeatmap.in_transition||e.value<=0)){var t=new Date(d3.select(this.parentNode).attr("date")),a=d3.select(this.parentNode).datum(),n=null;if(a)n=a.details.filter((function(t){return t.name==e.name}))[0];var r="";3==e.type?(r+='<div class="header"><strong>'+(a.strProjects?a.strProjects:e.name)+"</strong><div><br>",r+="<div>on "+moment(e.date).format("dddd, MMM Do YYYY")+"</div>"):(r+='<div class="header"><strong>'+(n?n.strProjects:a.strProjects?a.strProjects:e.name)+"</strong></div><br>",r+="<div><strong>"+(e.value?calendarHeatmap.formatTime(e.value):"No time")+" booked</strong></div>",r+="<div>on "+moment(t).format("dddd, MMM Do YYYY")+"</div>");for(var l=d(moment(t).week())+calendarHeatmap.settings.tooltip_padding;calendarHeatmap.settings.width-l<calendarHeatmap.settings.tooltip_width+3*calendarHeatmap.settings.tooltip_padding;)l-=10;var i=document.getElementById(calendarHeatmap.container).getBoundingClientRect().top>500?400:document.getElementById(calendarHeatmap.container).getBoundingClientRect().top,o=Math.abs(i-document.getElementById(calendarHeatmap.container).getBoundingClientRect().height)+calendarHeatmap.settings.tooltip_padding;calendarHeatmap.tooltip.html(r).style("left",l+"px").style("top",o+"px").transition().duration(calendarHeatmap.settings.transition_duration/2).ease(d3.easeLinear).style("opacity",1)}})).on("mouseout",(function(){calendarHeatmap.in_transition||calendarHeatmap.hideTooltip()})).transition().delay((function(){return(Math.cos(Math.PI*Math.random())+1)*calendarHeatmap.settings.transition_duration})).duration((function(){return calendarHeatmap.settings.transition_duration})).ease(d3.easeLinear).style("opacity",1).call((function(e,t){e.empty()&&t();var a=0;e.each((function(){++a})).on("end",(function(){--a||t.apply(this,arguments)}))}),(function(){calendarHeatmap.in_transition=!1}));s.selectAll(".text").remove(),s.selectAll(".text").data(["21/11"]).enter().append("text").attr("class","text").text((function(e,t){var a=d3.select(this.parentNode).datum().strWeekSummary?" ( "+d3.select(this.parentNode).datum().strWeekSummary+" )":"";return moment(d3.select(this.parentNode).attr("date")).format("DD/MM")+" : "+(d3.select(this.parentNode).attr("total")?calendarHeatmap.formatTime(d3.select(this.parentNode).attr("total"))+a:"No time")})).style("fill",(function(e,t){var a=calendarHeatmap.getTextColor(d3.select(this.parentNode).attr("total"),d3.select(this.parentNode).datum(),"");return d3.select(this.parentNode).attr("total")>0?a:"#bfbfbf"})).attr("text-anchor","left").attr("opacity","1").attr("y",(function(){return 15})).attr("x",(function(e){var t=parseInt(d3.select(this.parentNode).attr("total")),a=parseInt(d3.select(this.parentNode).attr("lblOffset"));return c.domain([0,t]),d3.select(this.parentNode).attr("lblOffset",a+c(e.value)),a})),calendarHeatmap.labels.selectAll(".label-week").remove(),calendarHeatmap.labels.selectAll(".label-week").data(o).enter().append("text").attr("class",(function(e){return moment(e).week()===calendarHeatmap.currDate.week()?"label label-week currMoment":"label label-week"})).attr("font-size",(function(e){return(moment(e).week()===calendarHeatmap.currDate.week()?Math.floor(calendarHeatmap.settings.label_padding/3)+1:Math.floor(calendarHeatmap.settings.label_padding/3))+"px"})).text((function(e){var t=moment().year(e.year()).week(e.week()).startOf("week").format("DD/MMM"),a=moment().year(e.year()).week(e.week()).endOf("week").format("DD/MMM");return"Week "+e.week()+" ("+t+" - "+a+")"})).attr("x",(function(e){return d(e.week())})).attr("y",calendarHeatmap.settings.label_padding/2).on("mouseenter",(function(e){calendarHeatmap.in_transition||calendarHeatmap.items.selectAll(".item-block-month").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",(function(t){return moment(t.date).week()===e.week()?1:.1}))})).on("mouseout",(function(){calendarHeatmap.in_transition||calendarHeatmap.items.selectAll(".item-block-month").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",1)})).on("click",(function(e){calendarHeatmap.in_transition||calendarHeatmap.data.filter((function(t){return e.startOf("week")<=moment(t.date)&&moment(t.date)<e.endOf("week")})).length&&(calendarHeatmap.in_transition=!0,calendarHeatmap.selected={date:e},calendarHeatmap.hideTooltip(),calendarHeatmap.removeMonthOverview(),calendarHeatmap.overview="week",calendarHeatmap.drawChart())})),calendarHeatmap.labels.selectAll(".label-day").remove(),calendarHeatmap.labels.selectAll(".label-day").data(l).enter().append("text").attr("class",(function(e){return moment(e).day()===calendarHeatmap.currDate.day()?"label label-day currMoment":"label label-day"})).attr("x",calendarHeatmap.settings.label_padding/3).attr("y",(function(e,t){return i(t)+i.bandwidth()/1.75})).style("text-anchor","left").attr("font-size",(function(e){return(moment(e).day()===calendarHeatmap.currDate.day()?Math.floor(calendarHeatmap.settings.label_padding/3)+1:Math.floor(calendarHeatmap.settings.label_padding/3))+"px"})).text((function(e){return moment(e).format("dddd")[0]+moment(e).format("dddd")[1]+moment(e).format("dddd")[2]})).on("mouseenter",(function(e){if(!calendarHeatmap.in_transition){var t=moment(e);calendarHeatmap.items.selectAll(".item-block-month").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",(function(e){return moment(e.date).day()===t.day()?1:.1}))}})).on("mouseout",(function(){calendarHeatmap.in_transition||calendarHeatmap.items.selectAll(".item-block-month").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",1)})),calendarHeatmap.drawButton()},drawMonthOverview2:function(){calendarHeatmap.items.selectAll(".text").remove(),calendarHeatmap.history[calendarHeatmap.history.length-1]!==calendarHeatmap.overview&&calendarHeatmap.history.push(calendarHeatmap.overview);for(var e=moment(calendarHeatmap.selected.date).startOf("month"),t=moment(calendarHeatmap.selected.date).endOf("month"),a=calendarHeatmap.data.filter((function(a){return e<=moment(a.date)&&moment(a.date)<t})),n=calendarHeatmap.mergeMissingDates(e,t,a),r=d3.max(n,(function(e){return d3.max(e.summary,(function(e){return e.value}))})),l=d3.timeDays(moment().startOf("week"),moment().endOf("week")),i=d3.scaleBand().rangeRound([calendarHeatmap.settings.label_padding,calendarHeatmap.settings.height-200]).domain(l.map((function(e){return moment(e).weekday()}))),o=[e.clone()];e.week()!==t.week();)o.push(e.add(1,"week").clone());var d=d3.scaleBand().rangeRound([calendarHeatmap.settings.label_padding,calendarHeatmap.settings.width-200]).padding([.05]).domain(o.map((function(e){return e.week()})));calendarHeatmap.labels.selectAll(".label-monthDate").remove(),calendarHeatmap.labels.selectAll(".label-dayDate").remove(),calendarHeatmap.items.selectAll(".item-block-month").remove();var s=calendarHeatmap.items.selectAll(".item-block-month").data(n).enter().append("g").attr("class","item item-block-month").attr("width",(function(){return(calendarHeatmap.settings.width-200-calendarHeatmap.settings.label_padding)/o.length-5*calendarHeatmap.settings.gutter})).attr("height",(function(){return Math.max(i.bandwidth(),calendarHeatmap.settings.max_block_height)-calendarHeatmap.settings.label_padding})).attr("transform",(function(e,t){return"translate("+d(moment(e.date).week())+","+(i(moment(e.date).weekday())+i.bandwidth()/1.75-15)+")"})).attr("total",(function(e){return e.total})).attr("date",(function(e){return e.date})).attr("offset",0).attr("lblOffset",0).on("click",(function(e){calendarHeatmap.in_transition||0!==e.total&&(calendarHeatmap.in_transition=!0,calendarHeatmap.selected=e,calendarHeatmap.hideTooltip(),calendarHeatmap.removeMonthOverview(),calendarHeatmap.overview="day",calendarHeatmap.drawChart())})),m=(calendarHeatmap.settings.width-200-calendarHeatmap.settings.label_padding)/o.length-5*calendarHeatmap.settings.gutter,c=d3.scaleLinear().rangeRound([0,m]);s.selectAll(".item-block-rect").data((function(e){return e.summary})).enter().append("rect").attr("class","item item-block-rect").attr("x",(function(e){var t=parseInt(d3.select(this.parentNode).attr("total")),a=parseInt(d3.select(this.parentNode).attr("offset"));return c.domain([0,t]),d3.select(this.parentNode).attr("offset",a+c(e.value)),a})).attr("stroke",(function(e){return e.value>0?"#292929":"#ccc"})).attr("width",(function(e){var t=parseInt(d3.select(this.parentNode).attr("total"));return c.domain([0,t]),e.value<=0?d3.select(this.parentNode).attr("width"):Math.max(c(e.value)-calendarHeatmap.settings.item_gutter,1)})).attr("height",(function(){return Math.min(i.bandwidth(),calendarHeatmap.settings.max_block_height)+.75*calendarHeatmap.settings.item_gutter+15})).attr("fill",(function(e){var t=[calendarHeatmap.getColor(e.value,d3.select(this.parentNode).datum()),calendarHeatmap.getColor(e.value,d3.select(this.parentNode).datum())],a=d3.scaleLinear().range(t).domain([-.15*r,r]);return e.value>0?a(e.value)||"#ff4500":"#fff"})).style("opacity",0).on("mouseover",(function(e){if(!(calendarHeatmap.in_transition||e.value<=0)){var t=new Date(d3.select(this.parentNode).attr("date")),a=d3.select(this.parentNode).datum(),n=null;if(a)n=a.details.filter((function(t){return t.name==e.name}))[0];var r="";3==e.type?(r+='<div class="header"><strong>'+(a.strProjects?a.strProjects:e.name)+"</strong><div><br>",r+="<div>on "+moment(e.date).format("dddd, MMM Do YYYY")+"</div>"):(r+='<div class="header"><strong>'+(n?n.strProjects:a.strProjects?a.strProjects:e.name)+"</strong></div><br>",r+="<div><strong>"+(e.value?calendarHeatmap.formatTime(e.value):"No time")+" booked</strong></div>",r+="<div>on "+moment(t).format("dddd, MMM Do YYYY")+"</div>");for(var l=d(moment(t).week())+calendarHeatmap.settings.tooltip_padding;calendarHeatmap.settings.width-l<calendarHeatmap.settings.tooltip_width+3*calendarHeatmap.settings.tooltip_padding;)l-=10;var i=document.getElementById(calendarHeatmap.container).getBoundingClientRect().top>500?400:document.getElementById(calendarHeatmap.container).getBoundingClientRect().top,o=Math.abs(i-document.getElementById(calendarHeatmap.container).getBoundingClientRect().height)+calendarHeatmap.settings.tooltip_padding;calendarHeatmap.tooltip.html(r).style("left",l+"px").style("top",o+"px").transition().duration(calendarHeatmap.settings.transition_duration/2).ease(d3.easeLinear).style("opacity",1)}})).on("mouseout",(function(){calendarHeatmap.in_transition||calendarHeatmap.hideTooltip()})).transition().delay((function(){return(Math.cos(Math.PI*Math.random())+1)*calendarHeatmap.settings.transition_duration})).duration((function(){return calendarHeatmap.settings.transition_duration})).ease(d3.easeLinear).style("opacity",1).call((function(e,t){e.empty()&&t();var a=0;e.each((function(){++a})).on("end",(function(){--a||t.apply(this,arguments)}))}),(function(){calendarHeatmap.in_transition=!1}));s.selectAll(".text").remove(),s.selectAll(".text").data(["21/11"]).enter().append("text").attr("class","text").text((function(e,t){console.log(d3.select(this.parentNode).datum());var a=d3.select(this.parentNode).datum().strWeekSummary;a=a?a.length>11?a.slice(0,11)+"...":a:"";var n=d3.select(this.parentNode).datum().strWeekSummary?" ( "+a+" )":"";return moment(d3.select(this.parentNode).attr("date")).format("DD/MM")+" : "+(d3.select(this.parentNode).attr("total")?calendarHeatmap.formatTime(d3.select(this.parentNode).attr("total"))+n:"No time")})).style("fill",(function(e,t){var a=calendarHeatmap.getTextColor(d3.select(this.parentNode).attr("total"),d3.select(this.parentNode).datum(),"");return d3.select(this.parentNode).attr("total")>0?a:"#bfbfbf"})).attr("text-anchor","left").attr("opacity","1").attr("y",(function(){return 15})).attr("x",(function(e){var t=parseInt(d3.select(this.parentNode).attr("total")),a=parseInt(d3.select(this.parentNode).attr("lblOffset"));return c.domain([0,t]),d3.select(this.parentNode).attr("lblOffset",a+c(e.value)),a+5})),calendarHeatmap.labels.selectAll(".label-week").remove(),calendarHeatmap.labels.selectAll(".label-week").data(o).enter().append("text").attr("class",(function(e){return moment(e).week()===calendarHeatmap.currDate.week()?"label label-week currMoment":"label label-week"})).attr("font-size",(function(e){return(moment(e).week()===calendarHeatmap.currDate.week()?Math.floor(calendarHeatmap.settings.label_padding/3)+1:Math.floor(calendarHeatmap.settings.label_padding/3))+"px"})).text((function(e){var t=moment().year(e.year()).week(e.week()).startOf("week").format("DD/MMM"),a=moment().year(e.year()).week(e.week()).endOf("week").format("DD/MMM");return"Week "+e.week()+" ("+t+" - "+a+")"})).attr("x",(function(e){return d(e.week())})).attr("y",calendarHeatmap.settings.label_padding/2).on("mouseenter",(function(e){calendarHeatmap.in_transition||calendarHeatmap.items.selectAll(".item-block-month").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",(function(t){return moment(t.date).week()===e.week()?1:.1}))})).on("mouseout",(function(){calendarHeatmap.in_transition||calendarHeatmap.items.selectAll(".item-block-month").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",1)})).on("click",(function(e){calendarHeatmap.in_transition||calendarHeatmap.data.filter((function(t){return e.startOf("week")<=moment(t.date)&&moment(t.date)<e.endOf("week")})).length&&(calendarHeatmap.in_transition=!0,calendarHeatmap.selected={date:e},calendarHeatmap.hideTooltip(),calendarHeatmap.removeMonthOverview(),calendarHeatmap.overview="week",calendarHeatmap.drawChart())})),calendarHeatmap.labels.selectAll(".label-day").remove(),calendarHeatmap.labels.selectAll(".label-day").data(l).enter().append("text").attr("class",(function(e){return moment(e).day()===calendarHeatmap.currDate.day()?"label label-day currMoment":"label label-day"})).attr("x",calendarHeatmap.settings.label_padding/3).attr("y",(function(e,t){return i(t)+i.bandwidth()/1.75})).style("text-anchor","left").attr("font-size",(function(e){return(moment(e).day()===calendarHeatmap.currDate.day()?Math.floor(calendarHeatmap.settings.label_padding/3)+1:Math.floor(calendarHeatmap.settings.label_padding/3))+"px"})).text((function(e){return moment(e).format("dddd")[0]+moment(e).format("dddd")[1]+moment(e).format("dddd")[2]})).on("mouseenter",(function(e){if(!calendarHeatmap.in_transition){var t=moment(e);calendarHeatmap.items.selectAll(".item-block-month").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",(function(e){return moment(e.date).day()===t.day()?1:.1}))}})).on("mouseout",(function(){calendarHeatmap.in_transition||calendarHeatmap.items.selectAll(".item-block-month").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",1)})),calendarHeatmap.drawButton()},drawWeekOverview:function(){calendarHeatmap.history[calendarHeatmap.history.length-1]!==calendarHeatmap.overview&&calendarHeatmap.history.push(calendarHeatmap.overview);var e=moment(calendarHeatmap.selected.date).startOf("week"),t=moment(calendarHeatmap.selected.date).endOf("week"),a=calendarHeatmap.data.filter((function(a){return e<=moment(a.date)&&moment(a.date)<t})),n=calendarHeatmap.mergeMissingDates(e,t,a),r=d3.max(n,(function(e){return d3.max(e.summary,(function(e){return e.value}))})),l=d3.timeDays(moment().startOf("week"),moment().endOf("week")),i=d3.scaleBand().rangeRound([calendarHeatmap.settings.label_padding,calendarHeatmap.settings.height-200]).domain(l.map((function(e){return moment(e).weekday()}))),o=[e],d=d3.scaleBand().rangeRound([calendarHeatmap.settings.label_padding,calendarHeatmap.settings.width-300]).padding([.05]).domain(o.map((function(e){return e.week()})));calendarHeatmap.items.selectAll(".text").remove(),calendarHeatmap.items.selectAll(".label-monthDate").remove(),calendarHeatmap.items.selectAll(".item-block-week").remove();var s=calendarHeatmap.items.selectAll(".item-block-week").data(n).enter().append("g").attr("class","item item-block-week").attr("width",(function(){return(calendarHeatmap.settings.width-300-calendarHeatmap.settings.label_padding)/o.length-5*calendarHeatmap.settings.gutter})).attr("height",(function(){return Math.min(i.bandwidth(),calendarHeatmap.settings.max_block_height)})).attr("transform",(function(e){return"translate("+d(moment(e.date).week())+","+(i(moment(e.date).weekday())+i.bandwidth()/1.75-15)+")"})).attr("total",(function(e){return e.total})).attr("date",(function(e){return e.date})).attr("offset",0).attr("lblOffset",0).on("click",(function(e){calendarHeatmap.in_transition||0!==e.total&&(calendarHeatmap.in_transition=!0,calendarHeatmap.selected=e,calendarHeatmap.hideTooltip(),calendarHeatmap.removeWeekOverview(),calendarHeatmap.overview="day",calendarHeatmap.drawChart())})),m=(calendarHeatmap.settings.width-300-calendarHeatmap.settings.label_padding)/o.length-5*calendarHeatmap.settings.gutter,c=d3.scaleLinear().rangeRound([0,m]);s.selectAll(".item-block-rect").data((function(e){return e.summary})).enter().append("rect").attr("class","item item-block-rect").attr("x",(function(e){var t=parseInt(d3.select(this.parentNode).attr("total")),a=parseInt(d3.select(this.parentNode).attr("offset"));return c.domain([0,t]),d3.select(this.parentNode).attr("offset",a+c(e.value)),a})).attr("width",(function(e){var t=parseInt(d3.select(this.parentNode).attr("total"));return c.domain([0,t]),e.value<=0?d3.select(this.parentNode).attr("width"):Math.max(c(e.value)-calendarHeatmap.settings.item_gutter,1)})).attr("stroke",(function(e){return d3.select(this.parentNode).attr("total")>0?"#292929":"#ccc"})).attr("height",(function(){return Math.min(i.bandwidth(),calendarHeatmap.settings.max_block_height)+15})).attr("fill",(function(e){var t=[calendarHeatmap.getColor(e.value,d3.select(this.parentNode).datum()),calendarHeatmap.getColor(e.value,d3.select(this.parentNode).datum())],a=d3.scaleLinear().range(t).domain([-.15*r,r]);return e.value>0?a(e.value)||"#ff4500":"#fff"})).style("opacity",0).on("mouseover",(function(e){if(!(calendarHeatmap.in_transition||e.value<=0)){var t=new Date(d3.select(this.parentNode).attr("date")),a="";console.log(d3.select(this.parentNode).datum()),console.log(e),3==e.type?(a+='<div class="header"><strong>'+d3.select(this.parentNode).datum().strProjects+"</strong><div><br>",a+="<div>on "+moment(e.date).format("dddd, MMM Do YYYY")+"</div>"):(a+='<div class="header"><strong>'+e.name+"</strong></div><br>",a+="<div><strong>"+(e.value?calendarHeatmap.formatTime(e.value):"No time")+" booked</strong></div>",a+="<div>on "+moment(t).format("dddd, MMM Do YYYY")+"</div>");var n=parseInt(d3.select(this.parentNode).attr("total"));c.domain([0,n]);for(var r=parseInt(d3.select(this).attr("x"))+c(e.value)/4+calendarHeatmap.settings.tooltip_width/4;calendarHeatmap.settings.width-r<calendarHeatmap.settings.tooltip_width+3*calendarHeatmap.settings.tooltip_padding;)r-=10;var l=document.getElementById(calendarHeatmap.container).getBoundingClientRect().top>500?400:document.getElementById(calendarHeatmap.container).getBoundingClientRect().top,i=Math.abs(l-document.getElementById(calendarHeatmap.container).getBoundingClientRect().height)+calendarHeatmap.settings.tooltip_padding;calendarHeatmap.tooltip.html(a).style("left",r+"px").style("top",i+"px").transition().duration(calendarHeatmap.settings.transition_duration/2).ease(d3.easeLinear).style("opacity",1)}})).on("mouseout",(function(){calendarHeatmap.in_transition||calendarHeatmap.hideTooltip()})).transition().delay((function(){return(Math.cos(Math.PI*Math.random())+1)*calendarHeatmap.settings.transition_duration})).duration((function(){return calendarHeatmap.settings.transition_duration})).ease(d3.easeLinear).style("opacity",1).call((function(e,t){e.empty()&&t();var a=0;e.each((function(){++a})).on("end",(function(){--a||t.apply(this,arguments)}))}),(function(){calendarHeatmap.in_transition=!1}));s.selectAll(".text").remove(),s.selectAll(".text").data(["21/11"]).enter().append("text").attr("class","text").text((function(e,t){var a=d3.select(this.parentNode).attr("total")&&d3.select(this.parentNode).attr("total")>0?calendarHeatmap.formatTime(d3.select(this.parentNode).attr("total"))+"    ;  ( "+d3.select(this.parentNode).datum().strProjects+" )":null;return moment(d3.select(this.parentNode).attr("date")).format("DD/MMM")+" : "+(a||" : - - ")})).style("fill",(function(e,t){var a=calendarHeatmap.getTextColor(d3.select(this.parentNode).attr("total"),d3.select(this.parentNode).datum(),"");return d3.select(this.parentNode).attr("total")>0?a:"#bfbfbf"})).attr("text-anchor","left").attr("opacity","1").attr("y",(function(){return 15})).attr("x",(function(e){var t=parseInt(d3.select(this.parentNode).attr("total")),a=parseInt(d3.select(this.parentNode).attr("lblOffset"));return c.domain([0,t]),d3.select(this.parentNode).attr("lblOffset",a+c(e.value)),a+30})),calendarHeatmap.labels.selectAll(".label-week").remove(),calendarHeatmap.labels.selectAll(".label-week").data(o).enter().append("text").attr("class","label label-week").attr("font-size",(function(){return Math.floor(calendarHeatmap.settings.label_padding/3)+"px"})).text((function(e){var t=moment().year(e.year()).week(e.week()).startOf("week").format("DD/MMM"),a=moment().year(e.year()).week(e.week()).endOf("week").format("DD/MMM");return"Week "+e.week()+" ("+t+" - "+a+")"})).attr("x",(function(e){return d(e.week())+100})).attr("y",calendarHeatmap.settings.label_padding/2).on("mouseenter",(function(e){calendarHeatmap.in_transition||calendarHeatmap.items.selectAll(".item-block-week").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",(function(t){return moment(t.date).week()===e.week()?1:.1}))})).on("mouseout",(function(){calendarHeatmap.in_transition||calendarHeatmap.items.selectAll(".item-block-week").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",1)})),calendarHeatmap.labels.selectAll(".label-monthDate").remove(),calendarHeatmap.labels.selectAll(".label-day").remove(),calendarHeatmap.labels.selectAll(".label-day").data(l).enter().append("text").attr("class","label label-day").attr("x",calendarHeatmap.settings.label_padding/3).attr("y",(function(e,t){return i(t)+i.bandwidth()/1.75})).style("text-anchor","left").attr("font-size",(function(){return Math.floor(calendarHeatmap.settings.label_padding/3)+"px"})).text((function(e){return moment(e).format("dddd")[0]+moment(e).format("dddd")[1]+moment(e).format("dddd")[2]})).on("mouseenter",(function(e){if(!calendarHeatmap.in_transition){var t=moment(e);calendarHeatmap.items.selectAll(".item-block-week").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",(function(e){return moment(e.date).day()===t.day()?1:.1}))}})).on("mouseout",(function(){calendarHeatmap.in_transition||calendarHeatmap.items.selectAll(".item-block-week").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",1)})),calendarHeatmap.drawButton()},drawDayOverview:function(){calendarHeatmap.history[calendarHeatmap.history.length-1]!==calendarHeatmap.overview&&calendarHeatmap.history.push(calendarHeatmap.overview),Object.keys(calendarHeatmap.selected).length||(calendarHeatmap.selected=calendarHeatmap.data[calendarHeatmap.data.length-1]);var e=calendarHeatmap.selected.summary.sort((function(e,t){return t.type<e.type})).map((function(e){return e.name})),t=d3.scaleBand().rangeRound([calendarHeatmap.settings.label_padding,calendarHeatmap.settings.height-200]).domain(e),a=d3.scaleTime().range([2*calendarHeatmap.settings.label_padding,calendarHeatmap.settings.width]).domain([moment(calendarHeatmap.selected.date).startOf("day"),moment(calendarHeatmap.selected.date).endOf("day")]);e.length;calendarHeatmap.items.selectAll(".text").remove(),calendarHeatmap.items.selectAll(".label-monthDate").remove(),calendarHeatmap.items.selectAll(".item-block-day").remove(),calendarHeatmap.items.selectAll(".item-block").remove();var n=calendarHeatmap.items.selectAll(".item-block").data(calendarHeatmap.selected.details).enter().append("g").attr("class","item item-block").attr("width",(function(e){var t=a(d3.timeSecond.offset(moment(e.date),e.value));return Math.max(t-a(moment(e.date)),1)})).attr("height",(function(){return Math.max(t.bandwidth(),calendarHeatmap.settings.max_block_height)+20})).attr("total",(function(e){return e.total})).attr("date",(function(e){return e.date})).attr("offset",0).attr("lblOffset",0);calendarHeatmap.items.selectAll(".text").remove(),calendarHeatmap.items.selectAll(".item-block-day").remove(),n.selectAll(".item-block").data(calendarHeatmap.selected.details).enter().append("rect").attr("class","item item-block-day").attr("x",(function(e){return a(moment(e.date))})).attr("y",(function(e){return t(e.name)+t.bandwidth()/4})).attr("width",(function(e){var t=a(d3.timeSecond.offset(moment(e.date),e.value));return Math.max(t-a(moment(e.date)),1)})).attr("height",(function(){return Math.min(t.bandwidth(),calendarHeatmap.settings.max_block_height)+30})).attr("stroke",(function(e){return e.value>0?"#292929":"#ccc"})).attr("fill",(function(e){return calendarHeatmap.getColor(e.value,e)})).style("opacity",0).on("mouseover",(function(e){if(!(calendarHeatmap.in_transition||e.value<=0)){var t="";3==e.type?(t+='<div class="header"><strong>'+e.strProjects+"</strong><div><br>",t+="<div>on "+moment(e.date).format("dddd, MMM Do YYYY")+"</div>"):(t+='<div class="header"><strong>'+e.strProjects+"</strong><div><br>",t+="<div><strong>"+(e.value?calendarHeatmap.formatTime(e.value):"No time")+" booked</strong></div>",t+="<div>on "+moment(e.date).format("dddd, MMM Do YYYY")+"</div>");for(var n=100*e.value/86400+a(moment(e.date));calendarHeatmap.settings.width-n<calendarHeatmap.settings.tooltip_width+3*calendarHeatmap.settings.tooltip_padding;)n-=10;var r=document.getElementById(calendarHeatmap.container).getBoundingClientRect().top>500?400:document.getElementById(calendarHeatmap.container).getBoundingClientRect().top,l=Math.abs(r-document.getElementById(calendarHeatmap.container).getBoundingClientRect().height)+calendarHeatmap.settings.tooltip_padding;calendarHeatmap.tooltip.html(t).style("left",n+"px").style("top",l+"px").transition().duration(calendarHeatmap.settings.transition_duration/2).ease(d3.easeLinear).style("opacity",1)}})).on("mouseout",(function(e){calendarHeatmap.in_transition||e.value<=0||calendarHeatmap.hideTooltip()})).on("click",(function(e){calendarHeatmap.handler&&"function"==typeof calendarHeatmap.handler&&calendarHeatmap.handler(e)})).transition().delay((function(){return(Math.cos(Math.PI*Math.random())+1)*calendarHeatmap.settings.transition_duration})).duration((function(){return calendarHeatmap.settings.transition_duration})).ease(d3.easeLinear).style("opacity",1).call((function(e,t){e.empty()&&t();var a=0;e.each((function(){++a})).on("end",(function(){--a||t.apply(this,arguments)}))}),(function(){calendarHeatmap.in_transition=!1})),calendarHeatmap.items.selectAll(".text").remove(),calendarHeatmap.items.selectAll(".text").data(calendarHeatmap.selected.details).enter().append("text").attr("class","text").text((function(e,t){var a=e.strProjects.replaceAll(e.name,"");return a=a.replaceAll("|",""),e.value?calendarHeatmap.formatTime(e.value):"No time"})).style("fill",(function(e,t){return calendarHeatmap.getTotalHours(e.value)>8?"#fff":"inherit"})).attr("text-anchor","left").attr("opacity","1").attr("x",(function(e){return a(moment(e.date))+5})).attr("y",(function(e){return t(e.name)+t.bandwidth()/4+15}));var r=d3.timeHours(moment(calendarHeatmap.selected.date).startOf("day"),moment(calendarHeatmap.selected.date).endOf("day")),l=d3.scaleTime().range([2*calendarHeatmap.settings.label_padding,calendarHeatmap.settings.width+20]).domain([0,r.length]);calendarHeatmap.labels.selectAll(".label-time").remove(),calendarHeatmap.labels.selectAll(".label-time").data(r).enter().append("text").attr("class","label label-time").attr("font-size",(function(){return Math.floor(calendarHeatmap.settings.label_padding/3)+"px"})).text((function(e,t){return 0==t?moment(e).format("DD/MMM"):moment(e).format("HH:mm")})).attr("x",(function(e,t){return l(t)-7})).attr("y",calendarHeatmap.settings.label_padding/2).on("mouseenter",(function(e){if(!calendarHeatmap.in_transition){var t=a(moment(e));calendarHeatmap.items.selectAll(".item-block").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",(function(e){var n=a(moment(e.date)),r=a(moment(e.date).add(e.value,"seconds"));return t>=n&&t<=r?1:.1}))}})).on("mouseout",(function(){calendarHeatmap.in_transition||calendarHeatmap.items.selectAll(".item-block").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",1)})),calendarHeatmap.labels.selectAll(".label-project").remove(),calendarHeatmap.labels.selectAll(".label-project").data(e).enter().append("text").attr("class","label label-project").attr("x",calendarHeatmap.settings.gutter).attr("y",(function(e){return t(e)+t.bandwidth()/4+5})).attr("min-height",(function(){return t.bandwidth()})).style("text-anchor","left").attr("font-size",(function(){return Math.floor(calendarHeatmap.settings.label_padding/3)+"px"})).text((function(e){return e})).each((function(){var e=d3.select(this);e.node().getComputedTextLength(),e.text()})).on("mouseenter",(function(e){calendarHeatmap.in_transition||calendarHeatmap.items.selectAll(".item-block").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",(function(t){return t.name===e?1:.1}))})).on("mouseout",(function(){calendarHeatmap.in_transition||calendarHeatmap.items.selectAll(".item-block").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",1)})),calendarHeatmap.drawButton()},drawButton:function(){calendarHeatmap.buttons.selectAll(".button").remove();var e=calendarHeatmap.buttons.append("g").attr("class","button button-back").style("opacity",0).on("click",(function(){calendarHeatmap.in_transition||(calendarHeatmap.in_transition=!0,"year"===calendarHeatmap.overview?calendarHeatmap.removeYearOverview():"month"===calendarHeatmap.overview?calendarHeatmap.removeMonthOverview():"week"===calendarHeatmap.overview?calendarHeatmap.removeWeekOverview():"day"===calendarHeatmap.overview&&calendarHeatmap.removeDayOverview(),calendarHeatmap.history.pop(),calendarHeatmap.overview=calendarHeatmap.history.pop(),calendarHeatmap.drawChart())}));e.append("circle").attr("cx",calendarHeatmap.settings.label_padding/2.25).attr("cy",calendarHeatmap.settings.label_padding/2.5).attr("r",calendarHeatmap.settings.item_size/2),e.append("text").attr("x",calendarHeatmap.settings.label_padding/2.25).attr("y",calendarHeatmap.settings.label_padding/2.5).attr("dy",(function(){return Math.floor(calendarHeatmap.settings.width/100)/3})).attr("font-size",(function(){return Math.floor(calendarHeatmap.settings.label_padding/3)+"px"})).html("&#x2190;"),e.transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",1)},removeGlobalOverview:function(){calendarHeatmap.items.selectAll(".item-block-year").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",0).remove(),calendarHeatmap.labels.selectAll(".label-year").remove()},removeYearOverview:function(){calendarHeatmap.items.selectAll(".item-rect").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",0).remove(),calendarHeatmap.labels.selectAll(".label-day").remove(),calendarHeatmap.labels.selectAll(".label-month").remove(),calendarHeatmap.hideBackButton()},removeMonthOverview:function(){calendarHeatmap.items.selectAll(".item-block-month").selectAll(".item-block-rect").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",0).attr("x",(function(e,t){return t%2==0?-calendarHeatmap.settings.width/3:calendarHeatmap.settings.width/3})).remove(),calendarHeatmap.labels.selectAll(".label-day").remove(),calendarHeatmap.labels.selectAll(".label-week").remove(),calendarHeatmap.hideBackButton()},removeWeekOverview:function(){calendarHeatmap.items.selectAll(".item-block-week").selectAll(".item-block-rect").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",0).attr("x",(function(e,t){return t%2==0?-calendarHeatmap.settings.width/3:calendarHeatmap.settings.width/3})).remove(),calendarHeatmap.labels.selectAll(".label-day").remove(),calendarHeatmap.labels.selectAll(".label-week").remove(),calendarHeatmap.hideBackButton()},removeDayOverview:function(){calendarHeatmap.items.selectAll(".item-block").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",0).attr("x",(function(e,t){return t%2==0?-calendarHeatmap.settings.width/3:calendarHeatmap.settings.width/3})).remove(),calendarHeatmap.labels.selectAll(".label-time").remove(),calendarHeatmap.labels.selectAll(".label-project").remove(),calendarHeatmap.hideBackButton()},hideTooltip:function(){calendarHeatmap.tooltip.transition().duration(calendarHeatmap.settings.transition_duration/2).ease(d3.easeLinear).style("opacity",0)},hideBackButton:function(){calendarHeatmap.buttons.selectAll(".button").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",0).remove()},formatTime:function(e){var t=Math.floor(e/3600),a=Math.floor((e-3600*t)/60),n="";return t>0&&(n+=1===t?"1 hr ":t+" hrs "),a>0&&(n+=1===a?"1 min":a+" mins"),0===t&&0===a&&(n=" - - "),n},getColor:function(e,t,a){t&&(e=t.total?t.total:t.value);var n=Math.floor(e/3600),r=(Math.floor((e-3600*n)/60),"#faf8f2");if(a?(r=a.match(/Sick/)?calendarHeatmap.objColorConfig.sick:r,r=a.match(/Annual/)?calendarHeatmap.objColorConfig.annual:r,r=a.match(/Public/)?calendarHeatmap.objColorConfig.pbh:r):n<8?r=calendarHeatmap.objColorConfig.lesshrs:8==n?r=calendarHeatmap.objColorConfig.equalhrs:n>8&&(r=calendarHeatmap.objColorConfig.overhrs),t&&(t.strToolTip||t.strProjects)){var l=t.strProjects?t.strProjects:t.strToolTip;r=l.match(/Sick/)?calendarHeatmap.objColorConfig.sick:r,r=l.match(/Annual/)?calendarHeatmap.objColorConfig.annual:r,r=l.match(/Public/)?calendarHeatmap.objColorConfig.pbh:r}return r},getTextColor(e,t,a){t&&(e=t.total?t.total:t.value);var n=Math.floor(e/3600),r=(Math.floor((e-3600*n)/60),"#fff");return a?(r=a&&a.match(/Sick/)?"inherit":r,r=a&&a.match(/Annual/)?"inherit":r,r=a&&a.match(/Public/)?"inherit":r):r=Math.floor(e/3600)>8?"#fff":"inherit",t&&t.type&&(r=[1,2,3].includes(t.type)?"inherit":r),r},getTotalHours:e=>Math.floor(e/3600),isCurrentMonth:function(e,t){var a=!1;return a=moment(e).date()==calendarHeatmap.currDate.date()&&moment(e).month()==calendarHeatmap.currDate.month()&&moment(e).year()==calendarHeatmap.currDate.year(),t&&"month"==t&&(a=moment(e).month()==calendarHeatmap.currDate.month()&&moment(e).year()==calendarHeatmap.currDate.year()),a},mergeMissingDates:function(e,t,a){var n=[],r=d3.timeDays(e,t);const l=d3.timeFormat("%Y-%m-%dT00:00:00");return r.forEach((function(e,t){var r=a.filter((function(t){return t.date==l(e)}));r&&r.length?n.push(r[0]):n.push({date:l(e),details:[],total:0,strProjects:"",strToolTip:"",type:4,summary:[{name:"No booking",type:4,value:0}]})})),n.sort((function(e,t){return moment(e.date)-moment(t.date)})),n},drawCompactDayOverview:function(){calendarHeatmap.history[calendarHeatmap.history.length-1]!==calendarHeatmap.overview&&calendarHeatmap.history.push(calendarHeatmap.overview),Object.keys(calendarHeatmap.selected).length||(calendarHeatmap.selected=calendarHeatmap.data[calendarHeatmap.data.length-1]);var e=calendarHeatmap.selected.summary.sort((function(e,t){return e.type-t.type||e.value-t.value})).map((function(e){return e.name})),t=d3.scaleBand().rangeRound([calendarHeatmap.settings.label_padding,calendarHeatmap.settings.height]).domain(e),a=moment(calendarHeatmap.selected.date).startOf("day"),n=d3.scaleTime().range([2*calendarHeatmap.settings.label_padding,calendarHeatmap.settings.width]).domain([moment(a).add(5,"hours"),moment(calendarHeatmap.selected.date).endOf("day")]);calendarHeatmap.items.selectAll(".text").remove(),calendarHeatmap.items.selectAll(".label-monthDate").remove(),calendarHeatmap.items.selectAll(".item-block-day").remove(),calendarHeatmap.items.selectAll(".item-block").remove();var r=calendarHeatmap.items.selectAll(".item-block").data(calendarHeatmap.selected.details).enter().append("g").attr("class","item item-block").attr("width",(function(e){var t=n(d3.timeSecond.offset(moment(e.date),e.value));return Math.max(t-n(moment(e.date)),1)})).attr("height",(function(){return Math.min(t.bandwidth(),calendarHeatmap.settings.max_block_height)})).attr("total",(function(e){return e.total})).attr("date",(function(e){return e.date})).attr("offset",0).attr("lblOffset",0);calendarHeatmap.items.selectAll(".text").remove(),calendarHeatmap.items.selectAll(".item-block-day").remove(),r.selectAll(".item-block").data(calendarHeatmap.selected.details).enter().append("rect").attr("class","item item-block-day").attr("x",(function(e){return n(moment(e.date))})).attr("y",(function(e,a){return t.bandwidth()*(a+1)/2+calendarHeatmap.settings.max_block_height-10*a})).attr("width",(function(e){var t=n(d3.timeSecond.offset(moment(e.date),e.value));return Math.max(t-n(moment(e.date)),1)})).attr("height",(function(){return Math.min(t.bandwidth(),calendarHeatmap.settings.max_block_height)})).attr("stroke",(function(e){return e.value>0?"#292929":"#ccc"})).attr("fill",(function(e){return calendarHeatmap.getColor(e.value,e)})).style("opacity",0).on("mouseover",(function(e){if(!(calendarHeatmap.in_transition||e.value<=0)){var t="";3==e.type?(t+='<div class="header"><strong>'+e.strProjects+"</strong><div><br>",t+="<div>on "+moment(e.date).format("dddd, MMM Do YYYY")+"</div>"):(t+='<div class="header"><strong>'+e.strProjects+"</strong><div><br>",t+="<div><strong>"+(e.value?calendarHeatmap.formatTime(e.value):"No time")+" booked</strong></div>",t+="<div>on "+moment(e.date).format("dddd, MMM Do YYYY")+"</div>");for(var a=100*e.value/86400+n(moment(e.date));calendarHeatmap.settings.width-a<calendarHeatmap.settings.tooltip_width+3*calendarHeatmap.settings.tooltip_padding;)a-=10;var r=document.getElementById(calendarHeatmap.container).getBoundingClientRect().top>500?400:document.getElementById(calendarHeatmap.container).getBoundingClientRect().top,l=Math.abs(r-document.getElementById(calendarHeatmap.container).getBoundingClientRect().height)+calendarHeatmap.settings.tooltip_padding;calendarHeatmap.tooltip.html(t).style("left",a+"px").style("top",l+"px").transition().duration(calendarHeatmap.settings.transition_duration/2).ease(d3.easeLinear).style("opacity",1)}})).on("mouseout",(function(e){calendarHeatmap.in_transition||e.value<=0||calendarHeatmap.hideTooltip()})).on("click",(function(e){calendarHeatmap.handler&&"function"==typeof calendarHeatmap.handler&&calendarHeatmap.handler(e)})).transition().delay((function(){return(Math.cos(Math.PI*Math.random())+1)*calendarHeatmap.settings.transition_duration})).duration((function(){return calendarHeatmap.settings.transition_duration})).ease(d3.easeLinear).style("opacity",1).call((function(e,t){e.empty()&&t();var a=0;e.each((function(){++a})).on("end",(function(){--a||t.apply(this,arguments)}))}),(function(){calendarHeatmap.in_transition=!1})),calendarHeatmap.items.selectAll(".text").remove(),calendarHeatmap.items.selectAll(".text").data(calendarHeatmap.selected.details).enter().append("text").attr("class","text").text((function(e,t){var a=e.strProjects.replaceAll(e.name,"");return a=a.replaceAll("|",""),e.value?calendarHeatmap.formatTime(e.value):"No time"})).style("fill",(function(e,t){return calendarHeatmap.getTotalHours(e.value)>8?"#fff":"inherit"})).attr("text-anchor","left").attr("opacity","1").attr("x",(function(e){return n(moment(e.date)+5)+5})).attr("y",(function(e,a){return t.bandwidth()*(a+1)/2+calendarHeatmap.settings.max_block_height-10*a+12}));var l=d3.timeHours(moment(calendarHeatmap.selected.date).startOf("day"),moment(calendarHeatmap.selected.date).endOf("day"));l.splice(0,5);var i=d3.scaleTime().range([2*calendarHeatmap.settings.label_padding,calendarHeatmap.settings.width+20]).domain([0,l.length]);calendarHeatmap.labels.selectAll(".label-time").remove(),calendarHeatmap.labels.selectAll(".label-time").data(l).enter().append("text").attr("class","label label-time").attr("font-size",(function(){return Math.floor(calendarHeatmap.settings.label_padding/3)+"px"})).text((function(e,t){return 0==t?moment(e).format("DD/MMM"):moment(e).format("HH:mm")})).attr("x",(function(e,t){return i(t)-7})).attr("y",calendarHeatmap.settings.label_padding/2).on("mouseenter",(function(e){if(!calendarHeatmap.in_transition){var t=n(moment(e));calendarHeatmap.items.selectAll(".item-block").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",(function(e){var a=n(moment(e.date)),r=n(moment(e.date).add(e.value,"seconds"));return t>=a&&t<=r?1:.1}))}})).on("mouseout",(function(){calendarHeatmap.in_transition||calendarHeatmap.items.selectAll(".item-block").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",1)})),calendarHeatmap.labels.selectAll(".label-project").remove(),calendarHeatmap.labels.selectAll(".label-project").data(e).enter().append("text").attr("class","label label-project").attr("x",calendarHeatmap.settings.gutter).attr("y",(function(e,a){return t.bandwidth()*(a+1)/2+calendarHeatmap.settings.max_block_height-10*a})).attr("min-height",(function(){return t.bandwidth()})).style("text-anchor","left").attr("font-size",(function(){return Math.floor(calendarHeatmap.settings.label_padding/3)+"px"})).text((function(e){return e})).each((function(){var e=d3.select(this);e.node().getComputedTextLength(),e.text()})).on("mouseenter",(function(e){calendarHeatmap.in_transition||calendarHeatmap.items.selectAll(".item-block").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",(function(t){return t.name===e?1:.1}))})).on("mouseout",(function(){calendarHeatmap.in_transition||calendarHeatmap.items.selectAll(".item-block").transition().duration(calendarHeatmap.settings.transition_duration).ease(d3.easeLinear).style("opacity",1)})),calendarHeatmap.drawButton()},drawNewDayOverview:function(){}};
